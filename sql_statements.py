# This is a list of our sql statements that are ran based on which file we are importing
# We use a function so we can input variables from across different modules

from secrets import rs_iam, s3_bucket, s3_file_key

def city_median_1_4br(file_name):
    
    table_name = file_name.lower().split(".csv")[0]
    
    statement = f"""
    
    DROP TABLE \"public\".\"{table_name}\";

    CREATE TABLE \"public\".\"{table_name}\" (
    \"id\" INTEGER NULL,
    \"RegionName\" VARCHAR NULL,
    \"State\" VARCHAR NULL,
    \"Metro\" VARCHAR NULL,
    \"CountyName\" VARCHAR NULL,
    \"SizeRank\" INT NULL,
    \"year_2010_02\" DECIMAL(18, 2) NULL,
    \"year_2010_03\" DECIMAL(18, 2) NULL,
    \"year_2010_04\" DECIMAL(18, 2) NULL,
    \"year_2010_05\" DECIMAL(18, 2) NULL,
    \"year_2010_06\" DECIMAL(18, 2) NULL,
    \"year_2010_07\" DECIMAL(18, 2) NULL,
    \"year_2010_08\" DECIMAL(18, 2) NULL,
    \"year_2010_09\" DECIMAL(18, 2) NULL,
    \"year_2010_10\" DECIMAL(18, 2) NULL,
    \"year_2010_11\" DECIMAL(18, 2) NULL,
    \"year_2010_12\" DECIMAL(18, 2) NULL,
    \"year_2011_01\" DECIMAL(18, 2) NULL,
    \"year_2011_02\" DECIMAL(18, 2) NULL,
    \"year_2011_03\" DECIMAL(18, 2) NULL,
    \"year_2011_04\" DECIMAL(18, 2) NULL,
    \"year_2011_05\" DECIMAL(18, 2) NULL,
    \"year_2011_06\" DECIMAL(18, 2) NULL,
    \"year_2011_07\" DECIMAL(18, 2) NULL,
    \"year_2011_08\" DECIMAL(18, 2) NULL,
    \"year_2011_09\" DECIMAL(18, 2) NULL,
    \"year_2011_10\" DECIMAL(18, 2) NULL,
    \"year_2011_11\" DECIMAL(18, 2) NULL,
    \"year_2011_12\" DECIMAL(18, 2) NULL,
    \"year_2012_01\" DECIMAL(18, 2) NULL,
    \"year_2012_02\" DECIMAL(18, 2) NULL,
    \"year_2012_03\" DECIMAL(18, 2) NULL,
    \"year_2012_04\" DECIMAL(18, 2) NULL,
    \"year_2012_05\" DECIMAL(18, 2) NULL,
    \"year_2012_06\" DECIMAL(18, 2) NULL,
    \"year_2012_07\" DECIMAL(18, 2) NULL,
    \"year_2012_08\" DECIMAL(18, 2) NULL,
    \"year_2012_09\" DECIMAL(18, 2) NULL,
    \"year_2012_10\" DECIMAL(18, 2) NULL,
    \"year_2012_11\" DECIMAL(18, 2) NULL,
    \"year_2012_12\" DECIMAL(18, 2) NULL,
    \"year_2013_01\" DECIMAL(18, 2) NULL,
    \"year_2013_02\" DECIMAL(18, 2) NULL,
    \"year_2013_03\" DECIMAL(18, 2) NULL,
    \"year_2013_04\" DECIMAL(18, 2) NULL,
    \"year_2013_05\" DECIMAL(18, 2) NULL,
    \"year_2013_06\" DECIMAL(18, 2) NULL,
    \"year_2013_07\" DECIMAL(18, 2) NULL,
    \"year_2013_08\" DECIMAL(18, 2) NULL,
    \"year_2013_09\" DECIMAL(18, 2) NULL,
    \"year_2013_10\" DECIMAL(18, 2) NULL,
    \"year_2013_11\" DECIMAL(18, 2) NULL,
    \"year_2013_12\" DECIMAL(18, 2) NULL,
    \"year_2014_01\" DECIMAL(18, 2) NULL,
    \"year_2014_02\" DECIMAL(18, 2) NULL,
    \"year_2014_03\" DECIMAL(18, 2) NULL,
    \"year_2014_04\" DECIMAL(18, 2) NULL,
    \"year_2014_05\" DECIMAL(18, 2) NULL,
    \"year_2014_06\" DECIMAL(18, 2) NULL,
    \"year_2014_07\" DECIMAL(18, 2) NULL,
    \"year_2014_08\" DECIMAL(18, 2) NULL,
    \"year_2014_09\" DECIMAL(18, 2) NULL,
    \"year_2014_10\" DECIMAL(18, 2) NULL,
    \"year_2014_11\" DECIMAL(18, 2) NULL,
    \"year_2014_12\" DECIMAL(18, 2) NULL,
    \"year_2015_01\" DECIMAL(18, 2) NULL,
    \"year_2015_02\" DECIMAL(18, 2) NULL,
    \"year_2015_03\" DECIMAL(18, 2) NULL,
    \"year_2015_04\" DECIMAL(18, 2) NULL,
    \"year_2015_05\" DECIMAL(18, 2) NULL,
    \"year_2015_06\" DECIMAL(18, 2) NULL,
    \"year_2015_07\" DECIMAL(18, 2) NULL,
    \"year_2015_08\" DECIMAL(18, 2) NULL,
    \"year_2015_09\" DECIMAL(18, 2) NULL,
    \"year_2015_10\" DECIMAL(18, 2) NULL,
    \"year_2015_11\" DECIMAL(18, 2) NULL,
    \"year_2015_12\" DECIMAL(18, 2) NULL,
    \"year_2016_01\" DECIMAL(18, 2) NULL,
    \"year_2016_02\" DECIMAL(18, 2) NULL,
    \"year_2016_03\" DECIMAL(18, 2) NULL,
    \"year_2016_04\" DECIMAL(18, 2) NULL,
    \"year_2016_05\" DECIMAL(18, 2) NULL,
    \"year_2016_06\" DECIMAL(18, 2) NULL,
    \"year_2016_07\" DECIMAL(18, 2) NULL,
    \"year_2016_08\" DECIMAL(18, 2) NULL,
    \"year_2016_09\" DECIMAL(18, 2) NULL,
    \"year_2016_10\" DECIMAL(18, 2) NULL,
    \"year_2016_11\" DECIMAL(18, 2) NULL,
    \"year_2016_12\" DECIMAL(18, 2) NULL,
    \"year_2017_01\" DECIMAL(18, 2) NULL,
    \"year_2017_02\" DECIMAL(18, 2) NULL,
    \"year_2017_03\" DECIMAL(18, 2) NULL,
    \"year_2017_04\" DECIMAL(18, 2) NULL,
    \"year_2017_05\" DECIMAL(18, 2) NULL,
    \"year_2017_06\" DECIMAL(18, 2) NULL,
    \"year_2017_07\" DECIMAL(18, 2) NULL,
    \"year_2017_08\" DECIMAL(18, 2) NULL,
    \"year_2017_09\" DECIMAL(18, 2) NULL,
    \"year_2017_10\" DECIMAL(18, 2) NULL,
    \"year_2017_11\" DECIMAL(18, 2) NULL,
    \"year_2017_12\" DECIMAL(18, 2) NULL,
    \"year_2018_01\" DECIMAL(18, 2) NULL,
    \"year_2018_02\" DECIMAL(18, 2) NULL,
    \"year_2018_03\" DECIMAL(18, 2) NULL,
    \"year_2018_04\" DECIMAL(18, 2) NULL,
    \"year_2018_05\" DECIMAL(18, 2) NULL,
    \"year_2018_06\" DECIMAL(18, 2) NULL,
    \"year_2018_07\" DECIMAL(18, 2) NULL,
    \"year_2018_08\" DECIMAL(18, 2) NULL,
    \"year_2018_09\" DECIMAL(18, 2) NULL,
    \"year_2018_10\" DECIMAL(18, 2) NULL,
    \"year_2018_11\" DECIMAL(18, 2) NULL,
    \"year_2018_12\" DECIMAL(18, 2) NULL,
    \"year_2019_01\" DECIMAL(18, 2) NULL,
    \"year_2019_02\" DECIMAL(18, 2) NULL,
    \"year_2019_03\" DECIMAL(18, 2) NULL,
    \"year_2019_04\" DECIMAL(18, 2) NULL,
    \"year_2019_05\" DECIMAL(18, 2) NULL,
    \"year_2019_06\" DECIMAL(18, 2) NULL,
    \"year_2019_07\" DECIMAL(18, 2) NULL,
    \"year_2019_08\" DECIMAL(18, 2) NULL,
    \"year_2019_09\" DECIMAL(18, 2) NULL,
    \"year_2019_10\" DECIMAL(18, 2) NULL,
    \"year_2019_11\" DECIMAL(18, 2) NULL,
    \"year_2019_12\" DECIMAL(18, 2) NULL
    ) ENCODE AUTO;
    
    COPY public.{table_name}
    FROM \'s3://{s3_bucket}/{s3_file_key}{file_name}\'
    iam_role \'{rs_iam}\'
    DELIMITER ','
    IGNOREHEADER AS 1;
    
    """
    
    return statement


def city_median_5br(file_name):
    
    table_name = file_name.lower().split(".csv")[0]
    
    statement = f"""

    DROP TABLE \"public\".\"{table_name}\";

    CREATE TABLE \"public\".\"{table_name}\"(
    \"id\" INTEGER NULL,
    \"RegionName\" VARCHAR NULL,
    \"State\" VARCHAR NULL,
    \"Metro\" VARCHAR NULL,
    \"CountyName\" VARCHAR NULL,
    \"SizeRank\" INTEGER NULL,
    \"year_2011_01\" DECIMAL NULL,
    \"year_2011_02\" DECIMAL NULL,
    \"year_2011_03\" DECIMAL NULL,
    \"year_2011_04\" DECIMAL NULL,
    \"year_2011_05\" DECIMAL NULL,
    \"year_2011_06\" DECIMAL NULL,
    \"year_2011_07\" DECIMAL NULL,
    \"year_2011_08\" DECIMAL NULL,
    \"year_2011_09\" DECIMAL NULL,
    \"year_2011_10\" DECIMAL NULL,
    \"year_2011_11\" DECIMAL NULL,
    \"year_2011_12\" DECIMAL NULL,
    \"year_2012_01\" DECIMAL NULL,
    \"year_2012_02\" DECIMAL NULL,
    \"year_2012_03\" DECIMAL NULL,
    \"year_2012_04\" DECIMAL NULL,
    \"year_2012_05\" DECIMAL NULL,
    \"year_2012_06\" DECIMAL NULL,
    \"year_2012_07\" DECIMAL NULL,
    \"year_2012_08\" DECIMAL NULL,
    \"year_2012_09\" DECIMAL NULL,
    \"year_2012_10\" DECIMAL NULL,
    \"year_2012_11\" DECIMAL NULL,
    \"year_2012_12\" DECIMAL NULL,
    \"year_2013_01\" DECIMAL NULL,
    \"year_2013_02\" DECIMAL NULL,
    \"year_2013_03\" DECIMAL NULL,
    \"year_2013_04\" DECIMAL NULL,
    \"year_2013_05\" DECIMAL NULL,
    \"year_2013_06\" DECIMAL NULL,
    \"year_2013_07\" DECIMAL NULL,
    \"year_2013_08\" DECIMAL NULL,
    \"year_2013_09\" DECIMAL NULL,
    \"year_2013_10\" DECIMAL NULL,
    \"year_2013_11\" DECIMAL NULL,
    \"year_2013_12\" DECIMAL NULL,
    \"year_2014_01\" DECIMAL NULL,
    \"year_2014_02\" DECIMAL NULL,
    \"year_2014_03\" DECIMAL NULL,
    \"year_2014_04\" DECIMAL NULL,
    \"year_2014_05\" DECIMAL NULL,
    \"year_2014_06\" DECIMAL NULL,
    \"year_2014_07\" DECIMAL NULL,
    \"year_2014_08\" DECIMAL NULL,
    \"year_2014_09\" DECIMAL NULL,
    \"year_2014_10\" DECIMAL NULL,
    \"year_2014_11\" DECIMAL NULL,
    \"year_2014_12\" DECIMAL NULL,
    \"year_2015_01\" DECIMAL NULL,
    \"year_2015_02\" DECIMAL NULL,
    \"year_2015_03\" DECIMAL NULL,
    \"year_2015_04\" DECIMAL NULL,
    \"year_2015_05\" DECIMAL NULL,
    \"year_2015_06\" DECIMAL NULL,
    \"year_2015_07\" DECIMAL NULL,
    \"year_2015_08\" DECIMAL NULL,
    \"year_2015_09\" DECIMAL NULL,
    \"year_2015_10\" DECIMAL NULL,
    \"year_2015_11\" DECIMAL NULL,
    \"year_2015_12\" DECIMAL NULL,
    \"year_2016_01\" DECIMAL NULL,
    \"year_2016_02\" DECIMAL NULL,
    \"year_2016_03\" DECIMAL NULL,
    \"year_2016_04\" DECIMAL NULL,
    \"year_2016_05\" DECIMAL NULL,
    \"year_2016_06\" DECIMAL NULL,
    \"year_2016_07\" DECIMAL NULL,
    \"year_2016_08\" DECIMAL NULL,
    \"year_2016_09\" DECIMAL NULL,
    \"year_2016_10\" DECIMAL NULL,
    \"year_2016_11\" DECIMAL NULL,
    \"year_2016_12\" DECIMAL NULL,
    \"year_2017_01\" DECIMAL NULL,
    \"year_2017_02\" DECIMAL NULL,
    \"year_2017_03\" DECIMAL NULL,
    \"year_2017_04\" DECIMAL NULL,
    \"year_2017_05\" DECIMAL NULL,
    \"year_2017_06\" DECIMAL NULL,
    \"year_2017_07\" DECIMAL NULL,
    \"year_2017_08\" DECIMAL NULL,
    \"year_2017_09\" DECIMAL NULL,
    \"year_2017_10\" DECIMAL NULL,
    \"year_2017_11\" DECIMAL NULL,
    \"year_2017_12\" DECIMAL NULL,
    \"year_2018_01\" DECIMAL NULL,
    \"year_2018_02\" DECIMAL NULL,
    \"year_2018_03\" DECIMAL NULL,
    \"year_2018_04\" DECIMAL NULL,
    \"year_2018_05\" DECIMAL NULL,
    \"year_2018_06\" DECIMAL NULL,
    \"year_2018_07\" DECIMAL NULL,
    \"year_2018_08\" DECIMAL NULL,
    \"year_2018_09\" DECIMAL NULL,
    \"year_2018_10\" DECIMAL NULL,
    \"year_2018_11\" DECIMAL NULL,
    \"year_2018_12\" DECIMAL NULL,
    \"year_2019_01\" DECIMAL NULL,
    \"year_2019_02\" DECIMAL NULL,
    \"year_2019_03\" DECIMAL NULL,
    \"year_2019_04\" DECIMAL NULL,
    \"year_2019_05\" DECIMAL NULL,
    \"year_2019_06\" DECIMAL NULL,
    \"year_2019_07\" DECIMAL NULL,
    \"year_2019_08\" DECIMAL NULL,
    \"year_2019_09\" DECIMAL NULL,
    \"year_2019_10\" DECIMAL NULL,
    \"year_2019_11\" DECIMAL NULL,
    \"year_2019_12\" DECIMAL NULL) ENCODE AUTO;
    
    COPY public.{table_name}
    FROM \'s3://{s3_bucket}/{s3_file_key}{file_name}\'
    iam_role \'{rs_iam}\'
    DELIMITER ','
    IGNOREHEADER AS 1;
    
    """
    
    return statement


def city_median_all_homes(file_name):
    
    table_name = file_name.lower().split(".csv")[0]
    
    statement = f"""
    
    DROP TABLE \"public\".\"{table_name}\";
    
    CREATE TABLE \"public\".\"{table_name}\"(
    \"id\" INTEGER NULL,
    \"RegionName\" VARCHAR NULL,
    \"State\" VARCHAR NULL,
    \"Metro\" VARCHAR NULL,
    \"CountyName\" VARCHAR NULL,
    \"SizeRank\" INTEGER NULL,
    \"year_2010_01\" DECIMAL NULL,
    \"year_2010_02\" DECIMAL NULL,
    \"year_2010_03\" DECIMAL NULL,
    \"year_2010_04\" DECIMAL NULL,
    \"year_2010_05\" DECIMAL NULL,
    \"year_2010_06\" DECIMAL NULL,
    \"year_2010_07\" DECIMAL NULL,
    \"year_2010_08\" DECIMAL NULL,
    \"year_2010_09\" DECIMAL NULL,
    \"year_2010_10\" DECIMAL NULL,
    \"year_2010_11\" DECIMAL NULL,
    \"year_2010_12\" DECIMAL NULL,
    \"year_2011_01\" DECIMAL NULL,
    \"year_2011_02\" DECIMAL NULL,
    \"year_2011_03\" DECIMAL NULL,
    \"year_2011_04\" DECIMAL NULL,
    \"year_2011_05\" DECIMAL NULL,
    \"year_2011_06\" DECIMAL NULL,
    \"year_2011_07\" DECIMAL NULL,
    \"year_2011_08\" DECIMAL NULL,
    \"year_2011_09\" DECIMAL NULL,
    \"year_2011_10\" DECIMAL NULL,
    \"year_2011_11\" DECIMAL NULL,
    \"year_2011_12\" DECIMAL NULL,
    \"year_2012_01\" DECIMAL NULL,
    \"year_2012_02\" DECIMAL NULL,
    \"year_2012_03\" DECIMAL NULL,
    \"year_2012_04\" DECIMAL NULL,
    \"year_2012_05\" DECIMAL NULL,
    \"year_2012_06\" DECIMAL NULL,
    \"year_2012_07\" DECIMAL NULL,
    \"year_2012_08\" DECIMAL NULL,
    \"year_2012_09\" DECIMAL NULL,
    \"year_2012_10\" DECIMAL NULL,
    \"year_2012_11\" DECIMAL NULL,
    \"year_2012_12\" DECIMAL NULL,
    \"year_2013_01\" DECIMAL NULL,
    \"year_2013_02\" DECIMAL NULL,
    \"year_2013_03\" DECIMAL NULL,
    \"year_2013_04\" DECIMAL NULL,
    \"year_2013_05\" DECIMAL NULL,
    \"year_2013_06\" DECIMAL NULL,
    \"year_2013_07\" DECIMAL NULL,
    \"year_2013_08\" DECIMAL NULL,
    \"year_2013_09\" DECIMAL NULL,
    \"year_2013_10\" DECIMAL NULL,
    \"year_2013_11\" DECIMAL NULL,
    \"year_2013_12\" DECIMAL NULL,
    \"year_2014_01\" DECIMAL NULL,
    \"year_2014_02\" DECIMAL NULL,
    \"year_2014_03\" DECIMAL NULL,
    \"year_2014_04\" DECIMAL NULL,
    \"year_2014_05\" DECIMAL NULL,
    \"year_2014_06\" DECIMAL NULL,
    \"year_2014_07\" DECIMAL NULL,
    \"year_2014_08\" DECIMAL NULL,
    \"year_2014_09\" DECIMAL NULL,
    \"year_2014_10\" DECIMAL NULL,
    \"year_2014_11\" DECIMAL NULL,
    \"year_2014_12\" DECIMAL NULL,
    \"year_2015_01\" DECIMAL NULL,
    \"year_2015_02\" DECIMAL NULL,
    \"year_2015_03\" DECIMAL NULL,
    \"year_2015_04\" DECIMAL NULL,
    \"year_2015_05\" DECIMAL NULL,
    \"year_2015_06\" DECIMAL NULL,
    \"year_2015_07\" DECIMAL NULL,
    \"year_2015_08\" DECIMAL NULL,
    \"year_2015_09\" DECIMAL NULL,
    \"year_2015_10\" DECIMAL NULL,
    \"year_2015_11\" DECIMAL NULL,
    \"year_2015_12\" DECIMAL NULL,
    \"year_2016_01\" DECIMAL NULL,
    \"year_2016_02\" DECIMAL NULL,
    \"year_2016_03\" DECIMAL NULL,
    \"year_2016_04\" DECIMAL NULL,
    \"year_2016_05\" DECIMAL NULL,
    \"year_2016_06\" DECIMAL NULL,
    \"year_2016_07\" DECIMAL NULL,
    \"year_2016_08\" DECIMAL NULL,
    \"year_2016_09\" DECIMAL NULL,
    \"year_2016_10\" DECIMAL NULL,
    \"year_2016_11\" DECIMAL NULL,
    \"year_2016_12\" DECIMAL NULL,
    \"year_2017_01\" DECIMAL NULL,
    \"year_2017_02\" DECIMAL NULL,
    \"year_2017_03\" DECIMAL NULL,
    \"year_2017_04\" DECIMAL NULL,
    \"year_2017_05\" DECIMAL NULL,
    \"year_2017_06\" DECIMAL NULL,
    \"year_2017_07\" DECIMAL NULL,
    \"year_2017_08\" DECIMAL NULL,
    \"year_2017_09\" DECIMAL NULL,
    \"year_2017_10\" DECIMAL NULL,
    \"year_2017_11\" DECIMAL NULL,
    \"year_2017_12\" DECIMAL NULL,
    \"year_2018_01\" DECIMAL NULL,
    \"year_2018_02\" DECIMAL NULL,
    \"year_2018_03\" DECIMAL NULL,
    \"year_2018_04\" DECIMAL NULL,
    \"year_2018_05\" DECIMAL NULL,
    \"year_2018_06\" DECIMAL NULL,
    \"year_2018_07\" DECIMAL NULL,
    \"year_2018_08\" DECIMAL NULL,
    \"year_2018_09\" DECIMAL NULL,
    \"year_2018_10\" DECIMAL NULL,
    \"year_2018_11\" DECIMAL NULL,
    \"year_2018_12\" DECIMAL NULL,
    \"year_2019_01\" DECIMAL NULL,
    \"year_2019_02\" DECIMAL NULL,
    \"year_2019_03\" DECIMAL NULL,
    \"year_2019_04\" DECIMAL NULL,
    \"year_2019_05\" DECIMAL NULL,
    \"year_2019_06\" DECIMAL NULL,
    \"year_2019_07\" DECIMAL NULL,
    \"year_2019_08\" DECIMAL NULL,
    \"year_2019_09\" DECIMAL NULL,
    \"year_2019_10\" DECIMAL NULL,
    \"year_2019_11\" DECIMAL NULL,
    \"year_2019_12\" DECIMAL NULL ) ENCODE AUTO;
        
    COPY public.{table_name}
    FROM \'s3://{s3_bucket}/{s3_file_key}{file_name}\'
    iam_role \'{rs_iam}\'
    DELIMITER ','
    IGNOREHEADER AS 1;
    """
    
    return statement

def city_median_sfr(file_name):
        
    table_name = file_name.lower().split(".csv")[0]
    
    statement = f"""
    
    DROP TABLE \"public\".\"{table_name}\";
    
    CREATE TABLE \"public\".\"{table_name}\"(
    \"id\" INTEGER NULL,
    \"RegionName\" VARCHAR NULL,
    \"State\" VARCHAR NULL,
    \"Metro\" VARCHAR NULL,
    \"CountyName\" VARCHAR NULL,
    \"SizeRank\" INTEGER NULL,
    \"year_2010_01\" DECIMAL NULL,
    \"year_2010_02\" DECIMAL NULL,
    \"year_2010_03\" DECIMAL NULL,
    \"year_2010_04\" DECIMAL NULL,
    \"year_2010_05\" DECIMAL NULL,
    \"year_2010_06\" DECIMAL NULL,
    \"year_2010_07\" DECIMAL NULL,
    \"year_2010_08\" DECIMAL NULL,
    \"year_2010_09\" DECIMAL NULL,
    \"year_2010_10\" DECIMAL NULL,
    \"year_2010_11\" DECIMAL NULL,
    \"year_2010_12\" DECIMAL NULL,
    \"year_2011_01\" DECIMAL NULL,
    \"year_2011_02\" DECIMAL NULL,
    \"year_2011_03\" DECIMAL NULL,
    \"year_2011_04\" DECIMAL NULL,
    \"year_2011_05\" DECIMAL NULL,
    \"year_2011_06\" DECIMAL NULL,
    \"year_2011_07\" DECIMAL NULL,
    \"year_2011_08\" DECIMAL NULL,
    \"year_2011_09\" DECIMAL NULL,
    \"year_2011_10\" DECIMAL NULL,
    \"year_2011_11\" DECIMAL NULL,
    \"year_2011_12\" DECIMAL NULL,
    \"year_2012_01\" DECIMAL NULL,
    \"year_2012_02\" DECIMAL NULL,
    \"year_2012_03\" DECIMAL NULL,
    \"year_2012_04\" DECIMAL NULL,
    \"year_2012_05\" DECIMAL NULL,
    \"year_2012_06\" DECIMAL NULL,
    \"year_2012_07\" DECIMAL NULL,
    \"year_2012_08\" DECIMAL NULL,
    \"year_2012_09\" DECIMAL NULL,
    \"year_2012_10\" DECIMAL NULL,
    \"year_2012_11\" DECIMAL NULL,
    \"year_2012_12\" DECIMAL NULL,
    \"year_2013_01\" DECIMAL NULL,
    \"year_2013_02\" DECIMAL NULL,
    \"year_2013_03\" DECIMAL NULL,
    \"year_2013_04\" DECIMAL NULL,
    \"year_2013_05\" DECIMAL NULL,
    \"year_2013_06\" DECIMAL NULL,
    \"year_2013_07\" DECIMAL NULL,
    \"year_2013_08\" DECIMAL NULL,
    \"year_2013_09\" DECIMAL NULL,
    \"year_2013_10\" DECIMAL NULL,
    \"year_2013_11\" DECIMAL NULL,
    \"year_2013_12\" DECIMAL NULL,
    \"year_2014_01\" DECIMAL NULL,
    \"year_2014_02\" DECIMAL NULL,
    \"year_2014_03\" DECIMAL NULL,
    \"year_2014_04\" DECIMAL NULL,
    \"year_2014_05\" DECIMAL NULL,
    \"year_2014_06\" DECIMAL NULL,
    \"year_2014_07\" DECIMAL NULL,
    \"year_2014_08\" DECIMAL NULL,
    \"year_2014_09\" DECIMAL NULL,
    \"year_2014_10\" DECIMAL NULL,
    \"year_2014_11\" DECIMAL NULL,
    \"year_2014_12\" DECIMAL NULL,
    \"year_2015_01\" DECIMAL NULL,
    \"year_2015_02\" DECIMAL NULL,
    \"year_2015_03\" DECIMAL NULL,
    \"year_2015_04\" DECIMAL NULL,
    \"year_2015_05\" DECIMAL NULL,
    \"year_2015_06\" DECIMAL NULL,
    \"year_2015_07\" DECIMAL NULL,
    \"year_2015_08\" DECIMAL NULL,
    \"year_2015_09\" DECIMAL NULL,
    \"year_2015_10\" DECIMAL NULL,
    \"year_2015_11\" DECIMAL NULL,
    \"year_2015_12\" DECIMAL NULL,
    \"year_2016_01\" DECIMAL NULL,
    \"year_2016_02\" DECIMAL NULL,
    \"year_2016_03\" DECIMAL NULL,
    \"year_2016_04\" DECIMAL NULL,
    \"year_2016_05\" DECIMAL NULL,
    \"year_2016_06\" DECIMAL NULL,
    \"year_2016_07\" DECIMAL NULL,
    \"year_2016_08\" DECIMAL NULL,
    \"year_2016_09\" DECIMAL NULL,
    \"year_2016_10\" DECIMAL NULL,
    \"year_2016_11\" DECIMAL NULL,
    \"year_2016_12\" DECIMAL NULL,
    \"year_2017_01\" DECIMAL NULL,
    \"year_2017_02\" DECIMAL NULL,
    \"year_2017_03\" DECIMAL NULL,
    \"year_2017_04\" DECIMAL NULL,
    \"year_2017_05\" DECIMAL NULL,
    \"year_2017_06\" DECIMAL NULL,
    \"year_2017_07\" DECIMAL NULL,
    \"year_2017_08\" DECIMAL NULL,
    \"year_2017_09\" DECIMAL NULL,
    \"year_2017_10\" DECIMAL NULL,
    \"year_2017_11\" DECIMAL NULL,
    \"year_2017_12\" DECIMAL NULL,
    \"year_2018_01\" DECIMAL NULL,
    \"year_2018_02\" DECIMAL NULL,
    \"year_2018_03\" DECIMAL NULL,
    \"year_2018_04\" DECIMAL NULL,
    \"year_2018_05\" DECIMAL NULL,
    \"year_2018_06\" DECIMAL NULL,
    \"year_2018_07\" DECIMAL NULL,
    \"year_2018_08\" DECIMAL NULL,
    \"year_2018_09\" DECIMAL NULL,
    \"year_2018_10\" DECIMAL NULL,
    \"year_2018_11\" DECIMAL NULL,
    \"year_2018_12\" DECIMAL NULL,
    \"year_2019_01\" DECIMAL NULL,
    \"year_2019_02\" DECIMAL NULL,
    \"year_2019_03\" DECIMAL NULL,
    \"year_2019_04\" DECIMAL NULL,
    \"year_2019_05\" DECIMAL NULL,
    \"year_2019_06\" DECIMAL NULL,
    \"year_2019_07\" DECIMAL NULL,
    \"year_2019_08\" DECIMAL NULL,
    \"year_2019_09\" DECIMAL NULL,
    \"year_2019_10\" DECIMAL NULL,
    \"year_2019_11\" DECIMAL NULL,
    \"year_2019_12\" DECIMAL NULL ) ENCODE AUTO;
    
    COPY public.{table_name}
    FROM \'s3://{s3_bucket}/{s3_file_key}{file_name}\'/
    iam_role \'{rs_iam}\'
    DELIMITER ','
    IGNOREHEADER AS 1;
    """
    
    return statement

def city_median_studio(file_name):
        
    table_name = file_name.lower().split(".csv")[0]
    
    statement = f"""
    
    DROP TABLE \"public\".\"{table_name}\";

    CREATE TABLE \"public\".\"{table_name}\"(
    \"id\" INTEGER NULL,
    \"RegionName\" VARCHAR NULL,
    \"State\" VARCHAR NULL,
    \"Metro\" VARCHAR NULL,
    \"CountyName\" VARCHAR NULL,
    \"SizeRank\" INTEGER NULL,
    \"year_2010_02\" DECIMAL NULL,
    \"year_2010_03\" DECIMAL NULL,
    \"year_2010_04\" DECIMAL NULL,
    \"year_2010_05\" DECIMAL NULL,
    \"year_2010_06\" DECIMAL NULL,
    \"year_2010_07\" DECIMAL NULL,
    \"year_2010_08\" DECIMAL NULL,
    \"year_2010_09\" DECIMAL NULL,
    \"year_2010_10\" DECIMAL NULL,
    \"year_2010_11\" DECIMAL NULL,
    \"year_2010_12\" DECIMAL NULL,
    \"year_2011_01\" DECIMAL NULL,
    \"year_2011_02\" DECIMAL NULL,
    \"year_2011_03\" DECIMAL NULL,
    \"year_2011_04\" DECIMAL NULL,
    \"year_2011_05\" DECIMAL NULL,
    \"year_2011_06\" DECIMAL NULL,
    \"year_2011_07\" DECIMAL NULL,
    \"year_2011_08\" DECIMAL NULL,
    \"year_2011_09\" DECIMAL NULL,
    \"year_2011_10\" DECIMAL NULL,
    \"year_2011_11\" DECIMAL NULL,
    \"year_2011_12\" DECIMAL NULL,
    \"year_2012_01\" DECIMAL NULL,
    \"year_2012_02\" DECIMAL NULL,
    \"year_2012_03\" DECIMAL NULL,
    \"year_2012_04\" DECIMAL NULL,
    \"year_2012_05\" DECIMAL NULL,
    \"year_2012_06\" DECIMAL NULL,
    \"year_2012_07\" DECIMAL NULL,
    \"year_2012_08\" DECIMAL NULL,
    \"year_2012_09\" DECIMAL NULL,
    \"year_2012_10\" DECIMAL NULL,
    \"year_2012_11\" DECIMAL NULL,
    \"year_2012_12\" DECIMAL NULL,
    \"year_2013_01\" DECIMAL NULL,
    \"year_2013_02\" DECIMAL NULL,
    \"year_2013_03\" DECIMAL NULL,
    \"year_2013_04\" DECIMAL NULL,
    \"year_2013_05\" DECIMAL NULL,
    \"year_2013_06\" DECIMAL NULL,
    \"year_2013_07\" DECIMAL NULL,
    \"year_2013_08\" DECIMAL NULL,
    \"year_2013_09\" DECIMAL NULL,
    \"year_2013_10\" DECIMAL NULL,
    \"year_2013_11\" DECIMAL NULL,
    \"year_2013_12\" DECIMAL NULL,
    \"year_2014_01\" DECIMAL NULL,
    \"year_2014_02\" DECIMAL NULL,
    \"year_2014_03\" DECIMAL NULL,
    \"year_2014_04\" DECIMAL NULL,
    \"year_2014_05\" DECIMAL NULL,
    \"year_2014_06\" DECIMAL NULL,
    \"year_2014_07\" DECIMAL NULL,
    \"year_2014_08\" DECIMAL NULL,
    \"year_2014_09\" DECIMAL NULL,
    \"year_2014_10\" DECIMAL NULL,
    \"year_2014_11\" DECIMAL NULL,
    \"year_2014_12\" DECIMAL NULL,
    \"year_2015_01\" DECIMAL NULL,
    \"year_2015_02\" DECIMAL NULL,
    \"year_2015_03\" DECIMAL NULL,
    \"year_2015_04\" DECIMAL NULL,
    \"year_2015_05\" DECIMAL NULL,
    \"year_2015_06\" DECIMAL NULL,
    \"year_2015_07\" DECIMAL NULL,
    \"year_2015_08\" DECIMAL NULL,
    \"year_2015_09\" DECIMAL NULL,
    \"year_2015_10\" DECIMAL NULL,
    \"year_2015_11\" DECIMAL NULL,
    \"year_2015_12\" DECIMAL NULL,
    \"year_2016_01\" DECIMAL NULL,
    \"year_2016_02\" DECIMAL NULL,
    \"year_2016_03\" DECIMAL NULL,
    \"year_2016_04\" DECIMAL NULL,
    \"year_2016_05\" DECIMAL NULL,
    \"year_2016_06\" DECIMAL NULL,
    \"year_2016_07\" DECIMAL NULL,
    \"year_2016_08\" DECIMAL NULL,
    \"year_2016_09\" DECIMAL NULL,
    \"year_2016_10\" DECIMAL NULL,
    \"year_2016_11\" DECIMAL NULL,
    \"year_2016_12\" DECIMAL NULL,
    \"year_2017_01\" DECIMAL NULL,
    \"year_2017_02\" DECIMAL NULL,
    \"year_2017_03\" DECIMAL NULL,
    \"year_2017_04\" DECIMAL NULL,
    \"year_2017_05\" DECIMAL NULL,
    \"year_2017_06\" DECIMAL NULL,
    \"year_2017_07\" DECIMAL NULL,
    \"year_2017_08\" DECIMAL NULL,
    \"year_2017_09\" DECIMAL NULL,
    \"year_2017_10\" DECIMAL NULL,
    \"year_2017_11\" DECIMAL NULL,
    \"year_2017_12\" DECIMAL NULL,
    \"year_2018_01\" DECIMAL NULL,
    \"year_2018_02\" DECIMAL NULL,
    \"year_2018_03\" DECIMAL NULL,
    \"year_2018_04\" DECIMAL NULL,
    \"year_2018_05\" DECIMAL NULL,
    \"year_2018_06\" DECIMAL NULL,
    \"year_2018_07\" DECIMAL NULL,
    \"year_2018_08\" DECIMAL NULL,
    \"year_2018_09\" DECIMAL NULL,
    \"year_2018_10\" DECIMAL NULL,
    \"year_2018_11\" DECIMAL NULL,
    \"year_2018_12\" DECIMAL NULL,
    \"year_2019_01\" DECIMAL NULL,
    \"year_2019_02\" DECIMAL NULL,
    \"year_2019_03\" DECIMAL NULL,
    \"year_2019_04\" DECIMAL NULL,
    \"year_2019_05\" DECIMAL NULL,
    \"year_2019_06\" DECIMAL NULL,
    \"year_2019_07\" DECIMAL NULL,
    \"year_2019_08\" DECIMAL NULL,
    \"year_2019_09\" DECIMAL NULL,
    \"year_2019_10\" DECIMAL NULL,
    \"year_2019_11\" DECIMAL NULL,
    \"year_2019_12\" DECIMAL NULL ) ENCODE AUTO;
    
    COPY public.{table_name}
    FROM \'s3://{s3_bucket}/{s3_file_key}{file_name}\'
    iam_role \'{rs_iam}\'
    DELIMITER ','
    IGNOREHEADER AS 1;
    """
    
    return statement
    
    
    